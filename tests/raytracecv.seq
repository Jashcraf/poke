! macro to run a grid raytrace and save the data
! current thought is a little janky, but let's experiment with buffer_to_array and array_to_buffer

num ^data(10,10) ^iter

! fresh env
len new

! turn on global coordinates
glo y

! turn on buffers
buf y

! load sample file
res hubble_test.len


! do a raytrace
rsi z1 w1 1 0 0 1

! load buffer to array
^result == BUFFER_TO_ARRAY(0,^data,8,(8+2),2,11,0)


wri "Array contents:"
FOR ^iter 1 10
    wri ^data(^iter,1) ^data(^iter,2) ^data(^iter,3) ^data(^iter,4) ^data(^iter,5) ^data(^iter,6) ^data(^iter,7) ^data(^iter,8) ^data(^iter,9) ^data(^iter,10)
END FOR
